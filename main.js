// For the script to function as intended, the events need to be written in chronological order by "start_date", and there cannot be any event with empty values of "start_date.year"

// Data
const GENInternationalData = {
    "title": {
        "media": {
          "url": "https://ecovillage.org/wp-content/uploads/2018/03/global-ecovillage-network-logo.png",
          "caption": "",
          "credit": ""
        },
        "text": {
          "headline": "Global Ecovillage Network: 1995-2022",
          "text": "<p>The Global Ecovillage Network (GEN) has now existed for 26 years and Gaia Education, which began as a GEN project, is celebrating its 16th year in teaching the principles of living sustainably.</p>"
        }
    },
    "events": [
      {
        "media": {
          "url": "https://mlwaayym0fy2.i.optimole.com/mCXH0oE-xG7JhdVe/w:300/h:100/q:auto/http://gaia.org/wp-content/uploads/2016/07/logo_gaiadotorg.png",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "1978"
        },
        "text": {
          "headline": "Gaia Trust",
          "text": "The impulse for the Global Ecovillage Network evolved from an initiative taken by Gaia Trust in 1990. Gaia Trust is a Danish-based charitable association founded by Ross and Hildur Jackson, with the intention of supporting the transition to a sustainable and more spiritual future society through grants and proactive initiatives."
        }
      },
      {
        "media": {
          "url": "https://mlwaayym0fy2.i.optimole.com/mCXH0oE-VXCg5FAq/w:auto/h:auto/q:auto/https://gaia.org/wp-content/uploads/2016/07/Fjordvang-world-university.jpg",
          "caption": "Fjordvang farm",
          "credit": ""
        },
        "start_date": {
          "year": "1990"
        },
        "text": {
          "headline": "Fjordvang farm",
          "text": "Hildur and Ross Jackson bought Fjordvang, the former \"World University\", a farm in western Denmark, which had been an international learning center for 25 years under the leadership of Aage Rosendal Nielsen."
        }
      },
      {
        "media": {
          "url": "https://www.context.org/wp-content/uploads/icimages/ic01f.jpg",
          "caption": "First issue of In Context magazine",
          "credit": ""
        },
        "start_date": {
          "year": "1991"
        },
        "text": {
          "headline": "Robert and Diane Gilman",
          "text": "Robert and Diane Gilman, editors of In Context magazine, moved to Fjordvang farm to build an ecovillage and work with the Jacksons on their common cause."
        }
      },
      {
        "media": {
          "url": "https://www.yanacomoxvalley.com/wp-content/uploads/2016/11/774408_orig.png",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "1991"
        },
        "text": {
          "headline": "\"Ecovillages and Sustainable Communities: A Report for Gaia Trust\"",
          "text": "The Gilmans made a report for Gaia Trust showing that, although many exciting and vastly different communities existed, a full-scale, ideal ecovillage did not yet exist. But, together, the existing projects made up a vision of a different culture and lifestyle that had great potential. In it, an ecovillage was defined as a: <br><br>\"Human-scale, full-featured settlement in which human activities are harmlessly integrated into the natural world in a way that is supportive of healthy human development and can be successfully continued into the indefinite future\".<br><br>https://www.context.org/iclib/ic29/gilman1/"
        }
      },
      {
        "media": {
          "url": "",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "1991"
        },
        "text": {
          "headline": "Meeting to discuss how to use Gaia Trust funds",
          "text": "Based on the Gilmans' report, twenty people from some of the best communities and a few broad thinkers were invited in September 1991 to discuss how Gaia Trust could best use its funds. The participants included a number of people who would later be key leaders of GEN — Max Lindegger, Declan Kennedy, and Albert Bates—as well as intellectuals outside of the ecovillage sphere, such as Karl-Henrik Robert, founder of The Natural Step , David Korten (who later wrote When Corporations Rule the World) and Marilyn Mehlmann of The Global Action Plan. The consensus that the group reached was that Gaia Trust should support the people who were actually living the new paradigm— ecovillagers, because they were essential for the transition, but were receiving no support from elsewhere. It became clear to all that the world needed good examples of what it means to live in harmony with nature in a sustainable and spiritually-satisfying way in a technologically advanced society."
        }
      },
      {
        "media": {
          "url": "https://image.isu.pub/130905132054-e49ce353972d50ae6eaf93f72ca57359/jpg/page_1_thumb_large.jpg",
          "caption": "National Association of Eco-Communities' membership magazine",
          "credit": ""
        },
        "start_date": {
          "year": "1994"
        },
        "text": {
          "headline": "Danish Ecovillage Network",
          "text": "Gaia Trust brought together a number of established and embryonic Danish ecovillages as the Danish Ecovillage Network — the first national network. A second global strategy meeting was called at Fjordvang with a smaller, strictly ecovillage group and a loose network was informally initiated with a secretariat in Denmark funded by Gaia Trust under the daily leadership of Hamish Stewart."
        }
      },
      {
        "media": {
          "url": "https://upload.wikimedia.org/wikipedia/commons/f/ff/Findhorn-Foundation-and-Community.jpg",
          "caption": "Findhorn community",
          "credit": ""
        },
        "start_date": {
          "year": "1995"
        },
        "text": {
          "headline": "Findhorn conference",
          "text": "A conference at Findhorn: \"Ecovillages and Sustainable Communities for the 21 Century\" was organized by the Findhorn community (led by John Talbot and Diane Gilman) and the evolving informal ecovillage network. It was a great success. The proceedings were published in 1996 by Findhorn Press — Ecovillages and Sustainable Communities; Models for 21 st Century Living . The conference was attended by over 400 people from forty countries, while another 300 who wished to be there had to be turned away. It was clear that the ecovillage concept had hit a sensitive nerve with a lot of people."
        }
      },
      {
        "media": {
          "url": "https://ecovillage.org/wp-content/uploads/drupal_files/images/newsmar15_5_0.jpg",
          "caption": "Founding group at Findhorn 1995",
          "credit": ""
        },
        "start_date": {
          "year": "1995"
        },
        "text": {
          "headline": "GEN Founding group",
          "text": "Immediately following this meeting, 20 people from different ecovillages met for five days and the Global Ecovillage Network was formally established, consisting of three regional networks to cover the globe geographically, with centers at ecovillages The Farm (USA), Lebensgarten (Germany) and Crystal Waters (Australia), with an international coordinating office at Gaia Trust, Denmark. Gaia Trust committed to covering the expenses of the network for 3-5 years. The plan was to focus initially on forming regional networks that would link existing projects. At the same time a second longer-term goal was set to create global services, like an education network, that would cut across regions, as soon as budgets and manpower permitted."
        }
      },
      {
        "media": {
          "url": "https://flic.kr/p/2n5zEjD",
          "caption": "At the exhibition of the UN Habitat in Istanbul, GEN's straw bale wall",
          "credit": ""
        },
        "start_date": {
          "year": "1996"
        },
        "text": {
          "headline": "UN Habitat II: Istanbul",
          "text": "At the Findhorn meeting it was decided — inspired by Rashmi Mayur\'s passionate presence — to join the United Nations Habitat II conference in Istanbul the following summer. A major exhibition at the NGO forum was built: a long straw bale wall, plastered with clay, so that it became an ideal place for posters with photos from ecovillages around the world. A model windmill, solar cells and running water contributed to a pleasant atmosphere. Hildur had prepared a booklet in 5000 copies called The Earth is Our Habitat. More than 40 workshops covering all issues of ecovillages and global politics were held. Outside, GEN was in charge of building an old Harran stone house with master builders from the region."
        }
      },
      {
        "media": {
          "url": "https://flic.kr/p/2n5y2kV",
          "caption": "The GEN Board takes a break on a Mexican pyramid",
          "credit": ""
        },
        "start_date": {
          "year": "1996"
        },
        "text": {
          "headline": "Regional Networks",
          "text": "The next three years were a period of building networks under the leadership of the three regional secretaries, namely Declan Kennedy, Albert Bates, and Max Lindegger, who constituted the initial GEN board, with coordination by Hamish Stewart, the International Secretary, based at Fjordvang.<br><br>This period resulted in the establishment and growth of three autonomous networksvcovering the globe: The Ecovillage Network of the Americas (ENA), GEN-Europe, whichvalso covered Africa for the time being, and GEN Asia/Oceania (GENOA). The GEN board met in many parts of the world during this time."
        }
      },
      {
        "media": {
          "url": "",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "2001"
        },
        "text": {
          "headline": "Gaia Trust Gears Down",
          "text": "In June 2001, Gaia Trust warned that its financial support to GEN would be gradually decreased over the next two years. GEN would have to find new sources of funding. This was because it was always Gaia Trust’s policy to use its capital over a relatively short period while its founders were still active, and also to ensure that GEN does not become dependent."
        }
      },
      {
        "media": {
          "url": "https://flic.kr/p/2n5zEpd",
          "caption": "Rashmi Mayur",
          "credit": ""
        },
        "start_date": {
          "year": "2002"
        },
        "text": {
          "headline": "The GEN Ambassador — Rashmi Mayur",
          "text": "No history of GEN would be complete without mentioning the special role played by the late Dr. Rashmi Mayur, leader of the International Institute for Sustainable Future in Mumbai, India.<br><br>Rashmi was unofficially GEN’s “ambassador to the UN”. He participated in all the big conferences as well as many planning meetings, as he was adviser to the UN and several Southern governments.<br>At the Johannesburg UN Earth Summit of August 2002, Rashmi was appointed official spokesman for the South, and had planned 28 major speeches and workshops. But he tragically suffered a debilitating stroke during his first speech, was unconscious for four months, slowly recovered all faculties but passed away in early 2004. He is greatly missed by all his colleagues who carry on his vision to create a more sustainable, more just world."
        }
      },
      {
        "media": {
          "url": "",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "2002"
        },
        "text": {
          "headline": "Of Learning and Immortality",
          "text": "Rashmi was also a highly developed spiritual person and an accomplished poet. Here is one poem on education written during the opening and read loud at the 1998 educationmconference at Fjordvang:<br><br><br><p style='text-align:center'><i><b>Of Learning and Immortality</b><br><br>Then they asked:<br>Master what is education?<br><br>The wise man spoke silently,<br><br>\"There is no master<br>and no education,<br>my people\"<br><br>People were bemused<br>Master continued,<br><br>\"Life is an opportunity<br>to realize ourselves.<br>We are creatures<br>of learning.<br>To learn is to be creative.<br>To learn is to know<br>the root of our existence.<br>To learn is to preserve<br>Our sacred Earth.<br>To learn is to live<br>in harmony with the whole.<br>To learn is to give<br>birth to the future.<br>To learn is to reach<br>enlightenment - Nirvana.<br>To learn is to be liberated<br>from the finiteness<br>of Space and Time<br>To learn is to be<br>immortal\".<br><br>Master was no more.<br></i></p>"
        }
      },
      {
        "media": {
          "url": "",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "2004"
        },
        "text": {
          "headline": "Cutting back on funding",
          "text": "As forewarned, Gaia Trust was forced to cut back on its level of funding for GEN by a factor of ten after July 2003. For all intents and purposes, GEN had become a volunteer organization.<br><br>After the cutback in 2003, GEN continued to develop slowly over the next six years or so. These were difficult years. A positive aspect was the annual GEN-Europe assembly, which attracted more and more people each year, as the ecovillage idea gradually spread, not least to Eastern Europe and Russia. With the introduction of the Gaia Education program in 2005, new life emerged in many ecovillages, as education was seen not only as a vehicle for local outreach but also for generating some income. The free material and a polished curriculum with UNITAR and UNESCO's stamp of approval made it easy to get started and attract people. Education was becoming an essential part of every ecovillage's story."
        }
      },
      {
        "media": {
          "url": "https://flic.kr/p/2n5y2jc",
          "caption": "May East, Gaia Education Chief International Officer, and Kosha Joubert.",
          "credit": ""
        },
        "start_date": {
          "year": "2008"
        },
        "text": {
          "headline": "Reviving GEN",
          "text": "A new activist phase in GEN's history began with the election of Kosha Joubert as president in 2008. Kosha was one of the 30 educators that had developed the Gaia Education curriculum and she had been very successful in introducing it to her ecovillage, Sieben Linden in Germany, inviting many foreign participants and getting financial support from the German government. One of the major goals of this time was to support the emergence of an independent African network which was initiated in 2012, with financial help, once again, from the German foreign ministry, which followed developments with great interest. <br><br>A new generation of GEN was very creative in extending its range of activities, while inspiring increasing momentum in all regions. A more streamlined organization and broader vision was established. In 2013, an independent South American network—CASA—evolved out of ENA. The youth organization, NextGEN, flourished."
        }
      },
      {
        "media": {
          "url": "",
          "caption": "",
          "credit": ""
        },
        "start_date": {
          "year": "2012"
        },
        "text": {
          "headline": "Gaia Trust rewards GEN initiatiors",
          "text": "In December 2012 the world was celebrating the end of one Mayan age and the beginning of a new one. Gaia Trust decided to give 5 rewards to 5 of the initiators and main persons of GEN and Gaia Education as symbols of all those having given birth to a new culture: Max Lindegger, Albert Bates and Declan Kennedy for building the GEN networks and to May East and Kosha Joubert for being inspiring leaders of Gaia Education and GEN in recent years.<br><br>By visiting an ecovillage like Findhorn, Sieben Linden, Tamera, Damanhur, Auroville or Ecovillage at Ithaca, you can experience a new culture emerging. They are all a little different but common is a whole body culture where people are in a process of change, where the goal is to live a full and joyful social life, while keeping the ecological footprint low, and not forgetting the old GEN saying: \"If it ain't fun, it ain't sustainable!\""
        }
      },      
    ]
};

const AHisStoryData = {
  "title": {
      "media": {
        "url": "https://flic.kr/p/2n5QAci",
        "caption": "At the Un the day before 9/11. L to R: Giovanni Ciarlo, Liora Adler, Linda Joseph, Lois Arkin, Albert Bates",
        "credit": ""
      },
      "text": {
        "headline": "A His Story of GEN",
        "text": "<p>by Albert Bates</p>"
      }
  },
  "events": [
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1991",
        "month": "9",
        "day": "11"
      },
      "end_date": {
        "year": "1991",
        "month": "9",
        "day": "15"
      },
      "text": {
        "headline": "Steps to a Sustainable Future, first Gaia Trust conference",
        "text": "<i>Thisted, Denmark</i> <br><br> This was an amazing, formative meeting, which I videotaped."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1992",
        "month": "4",
        "day": "9"
      },
      "end_date": {
        "year": "1992",
        "month": "4",
        "day": "4"
      },
      "text": {
        "headline": "\"The Farm and Plenty\"",
        "text": "<i>Helsinki, Finland</i> <br><br> With Diane Gilman and John Sharlet."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1992",
        "month": "4",
        "day": "11"
      },
      "end_date": {
        "year": "1992",
        "month": "4",
        "day": "11"
      },
      "text": {
        "headline": "\"The Farm as Ecovillage: A look back at the history of the 21st Century\"",
        "text": "<i>St. Petersburg, Russia</i> <br><br> With Volodya Shestakov."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1992",
        "month": "4",
        "day": "13"
      },
      "end_date": {
        "year": "1992",
        "month": "4",
        "day": "13"
      },
      "text": {
        "headline": "\"Climate Change, Diet, and Future History,\"",
        "text": "<i>St. Petersburg, Russia</i> <br><br> With Diane Gilman and John Sharlet, St. Petersburg Institute of Journalism (2 classes)"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1992",
        "month": "4",
        "day": "14"
      },
      "end_date": {
        "year": "1992",
        "month": "4",
        "day": "15"
      },
      "text": {
        "headline": "\"Farm to Ecovillage\"",
        "text": "<i>St. Petersburg, Russia</i> <br><br> With Diane Gilman, John Sharlet, Volodya Shestakov and Valentin Yemelin. At St. Petersburg TV Club, Russian Geographic Society, Vegetarian Society and Rotary Club. This Russian tour was important for me because at that time the former Soviet Union was making a historic transition to what it would next become and the slate was clean. Our ability to speak to so many groups of “influencers\" left a strong impression on both sides of that conversation. We invited Volodya and Valentin to the next meeting at Fjordvang."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1993",
        "month": "8",
        "day": "28"
      },
      "end_date": {
        "year": "1993",
        "month": "8",
        "day": "28"
      },
      "text": {
        "headline": "\"Ecovillages\" presentation at Celebration of Community",
        "text": "<i>Olympia WA </i> <br><br> Returning from the Fjordvang and Russian experiences I attended the triennial conference of the Fellowship for Intentional Community and gave a talk about ecovillages."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1993",
        "month": "9",
        "day": "28"
      },
      "end_date": {
        "year": "1993",
        "month": "9",
        "day": "28"
      },
      "text": {
        "headline": "\"Intentional Communities: From Crashpads to Ecovillages,\" presentation at Communities 2000 Conference",
        "text": "<i>The Farm, Summertown TN</i> <br><br> We had a follow-up communities conference at The Farm 2 months later, trying to look a decade ahead."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1994",
        "month": "4",
        "day": "20"
      },
      "end_date": {
        "year": "1994",
        "month": "4",
        "day": "25"
      },
      "text": {
        "headline": "Ecovillage Training Center planners meeting",
        "text": "<i>The Farm, Summertown TN</i>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1994",
        "month": "4",
        "day": ""
      },
      "end_date": {
        "year": "1995",
        "month": "4",
        "day": ""
      },
      "text": {
        "headline": "\"Basic Training For Eco-Villagers at The Farm in '95,\" in Communities 83:12",
        "text": "<i>The Farm, Summertown TN</i> <br><br> In April, 1994 I opened the first Ecovillage Training Center at my own community. In October, this training center hosted a gathering of environmental educators to address the idea of using ecovillages as platforms for advanced instruction and experimentation in concepts of sustainable culture. Daniel Greenberg attended. Similar meetings have continued to explore this theme ever since, such conferences at Findhorn in Scotland in 1995 and Damanhur in Italy in 2002. These processes formed the basis for the creation of Living Routes, Gaia University and Gaia Education Associates; new ways of approaching higher education in and through ecovillage experiences."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1994",
        "month": "6",
        "day": "8"
      },
      "end_date": {
        "year": "1994",
        "month": "6",
        "day": "15"
      },
      "text": {
        "headline": "GEN Planning Meetings",
        "text": "<i>Copenhagen, Denmark</i> and <i>Thisted, Germany</i>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1994",
        "month": "10",
        "day": "9"
      },
      "end_date": {
        "year": "1994",
        "month": "10",
        "day": "9"
      },
      "text": {
        "headline": "Ithaca Ecovillage Future Residents Organizing Group (FROG-1) Meeting",
        "text": "<i>Ithaca, NY</i> <br><br> Presentation on goals for GEN and ENA—The Big Picture."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1995",
        "month": "6",
        "day": "1"
      },
      "end_date": {
        "year": "1995",
        "month": "6",
        "day": "1"
      },
      "text": {
        "headline": "From Intentional Community to Ecovillage: ICSA Annual Meeting",
        "text": "<i>Ramat Efal, Israel</i> <br><br>  Yad Tabenkin (Seminar Efal). This was a significant event because it introduced the historic kibbutz movement to the modern ecovillage concept; introduced the International Communal Studies Association scholars to ecovillages for the first time; and brought about the formation of the Green Kibbutz Network, a node for ecovillages in the Middle East. It also introduced me, through Jan Bang, to Murad Al Khufash and the Marda Permaculture Center in the West Bank. This set in motion a collaboration between Palestinian ecovillagers and supporters in the West that continues today. It also promoted me to the board of directors of ICSA."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1995",
        "month": "6",
        "day": "5"
      },
      "end_date": {
        "year": "1995",
        "month": "6",
        "day": "5"
      },
      "text": {
        "headline": "Communal Societies and The Farm in American History",
        "text": "<i>Kibbutz Gezer, Israel</i> <br><br> Tel Aviv University outreach program"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1995",
        "month": "10",
        "day": "7"
      },
      "end_date": {
        "year": "1995",
        "month": "10",
        "day": "14"
      },
      "text": {
        "headline": "First International Conference on Ecovillages and Sustainable Communities",
        "text": "<i>Findhorn, Scotland</i> <br><br> Plenary Address “Utopiaor Eutopia,\" and workshops"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1995",
        "month": "10",
        "day": "12"
      },
      "end_date": {
        "year": "1995",
        "month": "10",
        "day": "14"
      },
      "text": {
        "headline": "Ecovillage Network of Americas organizational meetings",
        "text": "<i>Findhorn, Scotland</i> <br><br>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1995",
        "month": "10",
        "day": "10"
      },
      "end_date": {
        "year": "1995",
        "month": "10",
        "day": "18"
      },
      "text": {
        "headline": "Third GEN Meeting",
        "text": "<i>Findhorn, Scotland</i> <br><br>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1995",
        "month": "",
        "day": ""
      },
      "end_date": {
        "year": "2014",
        "month": "",
        "day": ""
      },
      "text": {
        "headline": "",
        "text": "Between 1995 and 2014, the ecovillage movement experienced viral growth: <ul><li>Kibbutzim that regreened the deserts of Palestine in the 20th century developed a new outlook with the formation of the Green Kibbutz Network.</li> <li>The Russian Ecovillage Network was inaugurated. Permaculture communities in Australia like Crystal Waters, Bundagen, and Jarlanbah, pioneered easy paths to more environmentally and sensitive lifestyles.</li> <li>Max Lindegger's Education Centre at Crystal Waters and Declan Kennedy's classes at Lebensgarten were exemplary and seminal. GEN-Europe hosted conferences attended by ecovillagers from dozens of countries, and national networks sprang up in many of them.</li> <li>In the Americas, nine offices were created to organize ecovillage regions by geography and language.</li> <li>By the turn of the 21st century GEN had more than 5,000 communities on six continents in its database, and had obtained consultative status at the United Nations.</li></ul>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "4",
        "day": "17"
      },
      "end_date": {
        "year": "1996",
        "month": "4",
        "day": "20"
      },
      "text": {
        "headline": "Fourth GEN Meeting",
        "text": "<i>The Farm, Summertown TN</i> <br><br>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "6",
        "day": ""
      },
      "end_date": {
        "year": "1996",
        "month": "6",
        "day": ""
      },
      "text": {
        "headline": "Presentation by representatives of Farm Ecovillage Training Center to high level officials meeting",
        "text": "<i>Brazilia, Brazil</i> <br><br>Seeking support for development of ecovillages and ecovillage training programs in all states of Brazil. While I was unable to attend this because I was in Istanbul, I sent two ecovillage representatives from my training center, one of whom was native Brazilian and the other had some Portuguese. They met with department heads and cabinet level officials and whetted their appetite for ecovillages. This later led to approx. $1 billion dollars in international grants to Brazil for sustainable development programs including permaculture trainings and ecovillage demonstration centers."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "6",
        "day": "7"
      },
      "end_date": {
        "year": "1996",
        "month": "6",
        "day": "16"
      },
      "text": {
        "headline": "United Nations Habitat II NGO Forum workshops and related receptions",
        "text": "<i>Istanbul, Turkey</i> <br><br> Thanks to excellent advance work by Turkish ecovillages and our envoys from GEN Europe, GEN had a prime location and amazing exhibits that made us one of the stars of this UN show. CINVA<br><br>Ram builders from Auroville built a small building outdoors. Our short film, Global Ecovillage Network, was played with audio track versions in 12 languages. Helena Norberg Hodge delivered a plenary address to UN delegates, written by Ross Jackson. Our very large delegation stayed at the Pera Palace, was feted at many receptions, gave daily workshops, principally for other NGOs, and made many important new contacts within the UN system. We were in many ways the most memorable part of that conference. And, oh, we also founded GEN."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "6",
        "day": "12"
      },
      "end_date": {
        "year": "1996",
        "month": "6",
        "day": "12"
      },
      "text": {
        "headline": "Fifth GEN Secretaries Meeting and corporate inauguration",
        "text": "<i>Istanbul, Turkey</i> <br><br>"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "6",
        "day": "17"
      },
      "end_date": {
        "year": "1996",
        "month": "6",
        "day": "19"
      },
      "text": {
        "headline": "GEN Presentations: American University of Cairo & New Basaisa and Old Basaisa Tour",
        "text": "<i>Cairo, Egypt</i> <br><br> "
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "6",
        "day": "23"
      },
      "end_date": {
        "year": "1996",
        "month": "6",
        "day": "28"
      },
      "text": {
        "headline": "Green Kibbutz Group gathering and speaking tour",
        "text": "<i>Kibbutz Gezer, Israel</i> <br><br> Harduf, Lotan, K'tura, Neot Smadar, Samar, Marda Permaculture Center, Kadita, Ein Gev, Degania Alef"
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "9",
        "day": "23"
      },
      "end_date": {
        "year": "1996",
        "month": "9",
        "day": "26"
      },
      "text": {
        "headline": "Sixth GEN Meeting",
        "text": "<i>Crystal Waters, Queensland, Australia</i> <br><br> "
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "9",
        "day": "28"
      },
      "end_date": {
        "year": "1996",
        "month": "9",
        "day": "28"
      },
      "text": {
        "headline": "Sixth International Permaculture Conference, Keynotes",
        "text": "<i>Perth, W. Australia</i> <br><br> These conferences and accompanying convergences of practitioners are important events in the permaculture world. The Perth conference was GEN's introduction and many of us were invited to speak to the plenary sessions and offer workshops. After this, ecovillages were firmly rooted in the permaculture curriculum."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "",
        "day": ""
      },
      "end_date": {
        "year": "1997",
        "month": "",
        "day": ""
      },
      "text": {
        "headline": "GEN appointed to UN Habitat \"Best Practices Committee\" membership",
        "text": "<i>Dubai, UAE</i> <br><br> Philip Snyder attended meetings in Dubai. This was one outcome of our Habitat II success. We were unable to devote the time required for this appointment and had to let it go after a year, but it was an indication of how highly we had become regarded within the UN system."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "10",
        "day": "10"
      },
      "end_date": {
        "year": "1996",
        "month": "10",
        "day": "13"
      },
      "text": {
        "headline": "\"Global Ecovillage Network\" and \"A personal Farm story,\" CSA 22nd Annual Meeting",
        "text": "<i>Amana, Iowa</i> <br><br> As a board member of ICSA, I gave talks at the annual meeting of the North American Communal Studies Association. I was later elected to their board of directors also. <br><br><i>\"...the ecovillage movement has a much better chance of achieving its broader utopian objectives than have previous ventures: they repudiate coercion, but can be widely attractive over time because they are simultaneously countercultural and pro-cultural, being in touch with deep sources in both traditional thought and contemporary understanding. The ecovillage movement is not just riding a short-term wave of economic and social disorder, but is at the front of an historic global transformation of human ways.\"</i><br><br> Prof. Robert Rosenthal, Hanover College, \"Villages, Ecovillages and Ecotopia,\" 1996."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "11",
        "day": "3"
      },
      "end_date": {
        "year": "1996",
        "month": "11",
        "day": "3"
      },
      "text": {
        "headline": "\"Global Ecovillage Network\" Society for Utopian Studies Annual Meeting",
        "text": "<i>Nashville, Texas</i> <br><br> Utopian studies can be differentiated from communal studies in that the former examines fictitious concepts and the later studies real world examples."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "11",
        "day": "16"
      },
      "end_date": {
        "year": "1996",
        "month": "11",
        "day": "24"
      },
      "text": {
        "headline": "Presentations: \"Global Ecovillage Network\" and \"Ecovillage Network of Americas,\" First Bioregional Congress of the Americas and Consejos de Visiones",
        "text": "<i>Camp Meztitla, Tepoztlan, Morelos, Mexico</i> <br><br> The Continental Bioregional Congress has been meeting since 1980 and I have attended most of the main conferences. This 1996 conference in Mexico was the first one outside the US and Canada. Introducing ecovillages to bioregionalists was like teaching fish to swim."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1996",
        "month": "",
        "day": ""
      },
      "end_date": {
        "year": "2006",
        "month": "",
        "day": ""
      },
      "text": {
        "headline": "World Bank support for national program of permaculture training and ecovillage development in Brazil",
        "text": "<i>Brazil</i> <br><br> Creation of IPA, IPEMA, Ecocentro, and other centers."
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1997",
        "month": "6",
        "day": "1"
      },
      "end_date": {
        "year": "1997",
        "month": "6",
        "day": "4"
      },
      "text": {
        "headline": "Permaculture City Conference",
        "text": "<i>Santa Rosa CA</i> <br><br> "
      }
    },
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "1997",
        "month": "6",
        "day": "2"
      },
      "end_date": {
        "year": "1997",
        "month": "6",
        "day": "2"
      },
      "text": {
        "headline": "Ecovillage Experiments Around the World",
        "text": "<i>San Rafael, CA</i> <br><br> Dominican College"
      }
    },
          
  ]
};

const NextGENData = {
  "title": {
      "media": {
        "url": "https://flic.kr/p/2n66rpf",
        "caption": "",
        "credit": ""
      },
      "text": {
        "headline": "NextGEN Story",
        "text": "<p></p>"
      }
  },
  "events": [
    {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "2006"
      },
      "text": {
        "headline": "The first sparkle of NextGEN",
        "text": "During the GEN+10 Conference at Findhorn, Scotland in 2006, momentum built to join together the Next GENeration of GEN - <b>NextGEN was born</b>. <br><br><i>While initially quite active, the group eventually lost momentum and became dormant.</i>"
      }
    },
    {
      "media": {
        "url": "https://flic.kr/p/2n64ZDy",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "2012"
      },
      "text": {
        "headline": "NextGEN's revival",
        "text": "This revival gained momentum in 2012, at the annual GEN-Europe Conference, and spread to other regions, generating an even bigger spark in NextGENOA (Asia, Oceania, and Australia), and expanding to NextGENNA (North America), NextGEN Africa, and now CASA Jovenes (Latin America). Meeting in ZEGG, + 50 people"
      }
    }, 
    {
      "media": {
        "url": "https://flic.kr/p/2n66z43",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": "2013"
      },
      "text": {
        "headline": "Roots of NextGEN",
        "text": "In July 2013, during the annual GEN-Europe Conference in Schweibenalp, Switzerland, NextGEN was deeply honored to receive the Gaia Excellence Award for the most inspiring project of the year. At the same time, we built upon the <b>existing internal structure of NextGEN</b> (elections of 2 representatives per regions + 3 international representatives), creating a Youth Council and our participation on the Network Steward Circle, the governance body of GEN."
      }
    }, 
    {
      "media": {
        "url": "https://flic.kr/p/2n66z62",
        "caption": "NextGENOA - EDE & meeting 2016",
        "credit": "Bopha"
      },
      "start_date": {
        "year": "2017"
      },
      "text": {
        "headline": "NextGEN growing and expanding",
        "text": "The NextGEN Regions have been taking solid steps towards this through focussing on some key areas as a way to strengthen our capacity as a network, such as: <ul><li>Organization</b>: Internal re-design of their structural foundation </li><li><b>Training</b>: The upskilling of young people interested in taking on leadership roles within the GEN networks </li><li><b>Events</b>: Organizing youth focused events and co-holding their corresponding regions annual conferences</li><li><b>Outreach</b>: Consolidating visual identity and online presence through websites, social media and other media content</li><li><b>Education</b>: The continuation of threading sustainability education throughout all events and projects.</li></ul> <br><br>Many projects are blossoming in the various regions of NextGEN. Just to highlight a few examples: <br><br><ul><li>Birth of NextGEN China</li><li>Development of Youth Exchanges in various ecovillages in Europe</li><li>Support to young people on attending and co-organizing the ECCO gathering in Brazil</li><li>Development of the “Ecovillage Pathways” event for young people in the USA</li><li>Summer youth camp in Cameroon.</li></ul>"
      }
    }, 
    {
      "media": {
        "url": "https://flic.kr/p/2n63QS6",
        "caption": "NextGEN presentation",
        "credit": ""
      },
      "start_date": {
        "year": "2020"
      },
      "text": {
        "headline": "NextGEN continues to grow",
        "text": "The network continues to expand, enrich its inner structure and develop projects to inspire, connect and empower youth within the ecovillage's movement and for the rise of a more regenerative world. <ul><li>Creation of NextGEN's website</li><li>Development of a NextGEN map</li><li>Online gathering with events around resilience and regeneration (deep ecology, social permaculture etc.) that helps us connect and keep our mission during the pandemic.</li></ul>"
      }
    }, 
/*     {
      "media": {
        "url": "",
        "caption": "",
        "credit": ""
      },
      "start_date": {
        "year": ""
      },
      "text": {
        "headline": "",
        "text": ""
      }
    },  */
          
  ]
};

// Variables
const filteredData = {
    "title": {},
    "events": []
}

let filteredDataCopy;

let startDate = {
  "month": 1,
  "year": 1977
};
let endDate = {
  "month": 1,
  "year": 2023
};

const writtenTags = [];

// Accessing HTML elements
const plusSign = document.getElementById("plus-sign");
const inputField = document.getElementById("written-tag-input");
const generateButton = document.getElementById("generate-button");
const radioInput = document.getElementsByName("database-selection")
const selectedStartYear = document.getElementById("start-year");
const selectedEndYear = document.getElementById("end-year");
// Not used
const selectedStartMonth = document.getElementById("start-month");
const selectedEndMonth = document.getElementById("end-month");

// Functions
const removeElement = function(element) {
    let tagNumber  = parseInt(element.parentElement.parentElement.id.slice(4));
    element.parentElement.parentElement.remove();
    writtenTags.splice(tagNumber-1, 1);

    for (let i=tagNumber ; i<writtenTags.length+1; i++){
        document.getElementById(`tag-${i+1}`).getElementsByTagName("td")[0].innerHTML = `${i}`;
        document.getElementById(`tag-${i+1}`).id = `tag-${i}`;
    }
};

const addElement = function () {

  inputValue = inputField.value;

  if (Boolean(inputValue) && !writtenTags.includes(inputValue)) {
    
    writtenTags.push(inputValue);
    let tagNumber = writtenTags.length;
    
    // creating new tr and td elements
    const newTr = document.createElement("tr");
    const newTdNumber = document.createElement("td");
    const newTdContent = document.createElement("td");
    const newTdMinusSign = document.createElement("td");
    const newTdMinusSignImage = document.createElement("img");

    // setting attributes
    newTr.setAttribute('id',`tag-${tagNumber}`);
    newTdNumber.setAttribute('class','tag');
    newTdContent.setAttribute('class','tag');
    newTdMinusSignImage.setAttribute('class','plus-minus-signs minus-signs');

    newTdMinusSignImage.setAttribute('onclick','removeElement(this)');

    // giving it content
    const TdNumber = document.createTextNode(tagNumber);
    const TdContent = document.createTextNode(inputValue);
    newTdMinusSignImage.setAttribute('src','./icons/minus-100-transparent.png');

    newTdNumber.appendChild(TdNumber);
    newTdContent.appendChild(TdContent);
    newTdMinusSign.appendChild(newTdMinusSignImage);
    
    // add the text node to the newly created div
    newTr.appendChild(newTdNumber);
    newTr.appendChild(newTdContent);
    newTr.appendChild(newTdMinusSign);

    // Insert the new element at the end of the tags-table
    document.getElementById("tags-table").appendChild(newTr);

    // clearing input field after the tag has been included
    inputField.value = '';
    document.getElementById("written-tag-input").focus();
  }       
  
  /*
  if (Boolean(inputValue)) {
      var tr = document.createElement('tr');
      var td = tr.appendChild(document.createElement('td'));
      td.innerHTML = inputValue;
      document.getElementById("tags-table").appendChild(tr);
  }
  */
};

const setDateRange = function(allData) {
  
  const yearOfFirstEvent = allData.events[0].start_date.year;
  const LastEvent = allData.events[allData.events.length-1]
  
  // checks if 's.sel' is between 's.data' and 'e.data', and if so, assigns that value to 'startDate'
  
  // selected              s.sel|-------------|e.sel
  // data        s.data|---------------|e.data

  if (selectedStartYear.value >= yearOfFirstEvent && selectedStartYear.value <= LastEvent.start_date.year) {
    startDate.year = selectedStartYear.value;
  } 

  // checks if 's.sel' is smaller 's.data', and if so, assigns 's.data' to 'startDate'
  
  // selected     s.sel|-------------|e.sel
  // data                s.data|---------------|e.data

  else if (selectedStartYear.value <= yearOfFirstEvent) {
    startDate.year = yearOfFirstEvent;
  }

  //Otherwise the selected range doesn't intersect with the data, and the value is set to negative to indicate error by out of range

  else {
    startDate.year = -1;
  }


  // checks if 'e.sel' is between 's.data' and 'e.data', and if so, assigns that value to 'endtDate'
  
  // selecte       s.sel|-------------|e.sel
  // data              s.data|---------------|e.data

  if (selectedEndYear.value >= yearOfFirstEvent && selectedEndYear.value <= LastEvent.start_date.year) {
    endDate.year = selectedEndYear.value;
  } 

  // checks if 'e.sel' is larger 'e.data', and if so, assigns 'e.sel' to 'endDate'
  
  // selected               s.sel|-------------|e.sel
  // data        s.data|---------------|e.data

  else if (selectedEndYear.value >= LastEvent.start_date.year) {
    if(LastEvent.start_date.year) {
      endDate.year = LastEvent.start_date.year;
    }
  }

  //Otherwise the selected range doesn't intersect with the data, and the value is set to negative to indicate error by out of range

  else {
    endDate.year = -1;
  }

  
}

const filterFunction = function(allData) {
  // function to create a filtered object by searching at:
  // allData.events.text.headline
  // and
  // allData.events.text.text

  // initialize the filteredData object
  filteredData.title = allData.title;
  filteredData.events = [];

  // initialize the inlcudedEvent array
  let includedEvent = new Array(allData.events.length); 
  for (let i=0; i<allData.events.length; ++i) {

      includedEvent[i] = false;

  }

  // sets the date range that will be used to select the events to be iterated through when looking for matches with the writtenTags
  setDateRange(allData);
  
  // If any of the two variables is negative means that the dates do not overlap, and a error message is displayed
  if (startDate.year<0 || endDate.year<0) {
    filteredData.title = {};
    filteredData.events = [];
    document.getElementById('no-events').hidden = false;
    return;
  }

  // push elements into filteredData if they match any written tag

  for (let i=0; i<allData.events.length; i++) {

    if (allData.events[i].start_date.year >= startDate.year && allData.events[i].start_date.year <= endDate.year) {

      // if no tags are input, include all events within date range
      if(writtenTags.length == 0) {
        filteredData.events.push(allData.events[i]);
        includedEvent[i] = true;
      }

      // otherwise include only those matching the tags withing date range
      else {

        for (let j=0; j<writtenTags.length; j++) {

          if (!includedEvent[i]) {
              
            if(allData.events[i].text.headline.toLowerCase().includes(writtenTags[j].toLowerCase())) {

                filteredData.events.push(allData.events[i]);
                includedEvent[i] = true;
            } 
            
            else if(allData.events[i].text.text.toLowerCase().includes(writtenTags[j].toLowerCase())) {

                filteredData.events.push(allData.events[i]);
                includedEvent[i] = true;
            }
          }
        }
      }
    }
  }

};

const generateTimeline = function() {

  // Hide whatever alert messages may be on display
  document.getElementById('no-events').hidden = true;

  //Calling the filterFunction with the correspoding data
  for (let i=0; i<radioInput.length; i++) {
    if(radioInput[i].checked) {
      filterFunction(eval(radioInput[i].value));
      break;
    }
  }

  if (filteredData.events.length == 0) {
    document.getElementById('no-events').hidden = false;
  }

  // Passing a copy, otherwise the object is modified when called through the TL.Timeline function in timelineSource.js, and becomes unfunctional for the setDateRange function
  filteredDataCopy = JSON.parse(JSON.stringify(filteredData));

  const script = document.createElement('script');
  script.src = './timelineSource.js';

  // Remove previous script (first time there's none)
  let element = document.getElementById("timeline-scripts");
while (element.firstChild) {
  element.removeChild(element.firstChild);
};
  // Append to the 'body' element
  document.getElementById("timeline-scripts").appendChild(script);
};

// Event listeners
window.onload = function() {
    inputField.focus();
};
plusSign.onclick = addElement;
inputField.onkeyup = function(event){
    if (event.keyCode == 13){
        addElement();
    }
};

generateButton.onclick = generateTimeline;


